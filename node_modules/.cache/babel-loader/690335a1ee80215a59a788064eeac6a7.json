{"ast":null,"code":"import _regeneratorRuntime from\"/home/user/Desktop/project/iqoption/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/user/Desktop/project/iqoption/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/user/Desktop/project/iqoption/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import storage from'../../utils/storage';import schedule from'node-schedule';import IQOption from'iqoptionzzz';import operate from'../../utils/operate';import axios from'axios';import{toast}from'react-toastify';import{Div,DivChange,DivConfig,DivStarted,StartBot}from'./styled';import{useSelector,useDispatch}from'react-redux';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function LoginIQ(_ref){var history=_ref.history;var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),stopWin=_React$useState2[0],setStopWin=_React$useState2[1];var _React$useState3=React.useState(0),_React$useState4=_slicedToArray(_React$useState3,2),stopLoss=_React$useState4[0],setStopLoss=_React$useState4[1];var _React$useState5=React.useState(0),_React$useState6=_slicedToArray(_React$useState5,2),delay=_React$useState6[0],setDelay=_React$useState6[1];var _React$useState7=React.useState(),_React$useState8=_slicedToArray(_React$useState7,2),file=_React$useState8[0],setFile=_React$useState8[1];var _React$useState9=React.useState(false),_React$useState10=_slicedToArray(_React$useState9,2),balance=_React$useState10[0],setBalance=_React$useState10[1];var _React$useState11=React.useState('Configurar'),_React$useState12=_slicedToArray(_React$useState11,2),buttonName=_React$useState12[0],setButtonName=_React$useState12[1];var _React$useState13=React.useState(0),_React$useState14=_slicedToArray(_React$useState13,2),entrada=_React$useState14[0],setEntrada=_React$useState14[1];var _React$useState15=React.useState(0),_React$useState16=_slicedToArray(_React$useState15,2),martinGales=_React$useState16[0],setMartinGales=_React$useState16[1];var _React$useState17=React.useState({time:'',active:'',direction:''}),_React$useState18=_slicedToArray(_React$useState17,2),oldTrade=_React$useState18[0],setOldTrade=_React$useState18[1];var _React$useState19=React.useState({time:'',active:'',direction:''}),_React$useState20=_slicedToArray(_React$useState19,2),nextTrade=_React$useState20[0],setNextTrade=_React$useState20[1];var buttonStart=React.useRef();var div=React.useRef();var divConfig=React.useRef();var divChange=React.useRef();var divStarted=React.useRef();var martin=React.useRef();var iqoption=useSelector(function(state){return state.iqoption;});var dispatch=useDispatch();function handleClick(_x){return _handleClick.apply(this,arguments);}function _handleClick(){_handleClick=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var errors,gales,i,formData,_yield$axios$post,data,API;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(buttonStart.current.innerText==='Stop')){_context2.next=10;break;}divStarted.current.style.display='none';buttonStart.current.innerText='Start';buttonStart.current.style.backgroundColor='green';div.current.style.display='block';divChange.current.style.display='block';Object.keys(schedule.scheduledJobs).forEach(function(key){schedule.scheduledJobs[key].cancel();});setOldTrade({time:'',active:'',direction:''});setNextTrade({time:'',active:'',direction:''});return _context2.abrupt(\"return\");case 10:errors=[];if(!stopWin)errors.push('Preencha stopWin');if(!stopLoss)errors.push('Preencha stopLoss');if(!file)errors.push('Coloque uma lista');if(!entrada)errors.push('Coloque uma entrada');if(!(errors.length>0)){_context2.next=17;break;}return _context2.abrupt(\"return\",errors.forEach(function(value){toast.error(value);}));case 17:if(buttonStart.current.innerText==='Start'){buttonStart.current.innerText='Stop';buttonStart.current.style.backgroundColor='red';div.current.style.display='none';divConfig.current.style.display='none';divChange.current.style.display='none';divStarted.current.style.display='block';}gales=[];gales.push(Number(entrada));for(i=0;martinGales>i;i++){gales.push(gales[gales.length-1]*2);}storage.setStopLoss(stopLoss);storage.setStopWin(stopWin);storage.setMartinGales(gales);formData=new FormData();formData.append('file',file);_context2.prev=26;_context2.next=29;return axios.post(\"http://\".concat(process.env.REACT_APP_HOST_APP,\"/api/v2/sinais\"),formData,{headers:{'Content-Type':'multipart/form-data'}});case 29:_yield$axios$post=_context2.sent;data=_yield$axios$post.data;if(!(data.length===0)){_context2.next=33;break;}return _context2.abrupt(\"return\",toast.error('Por favor adicione pelo menos 2 trades a lista'));case 33:_context2.prev=33;_context2.next=36;return toast.promise(IQOption({email:iqoption.email,password:iqoption.password}),{pending:'Aguarde',success:'Bot inicializado, nao feche o navegador',error:'Erro ao iniciar o bot'});case 36:API=_context2.sent;console.log('IQOPTION CONNECTED');setNextTrade({active:data[0].active,direction:data[0].direction,time:\"\".concat(data[0].time.hour,\":\").concat(data[0].time.minutes)});data.forEach(function(value,index,array){var minutes=delay?value.time.miutes-1:value.time.miutes;schedule.scheduleJob({hour:value.time.hour,minute:minutes,second:60-delay},function(){try{var indexOld=index-1;if(index===0)indexOld=0;var indexNew=index+1;if(array.length-1===index)indexNew=index;setOldTrade({active:array[indexOld].active,direction:array[indexOld].direction,time:\"\".concat(array[indexOld].time.hour,\":\").concat(array[indexOld].time.minutes)});setNextTrade({active:array[indexNew].active,direction:array[indexNew].direction,time:\"\".concat(array[indexNew].time.hour,\":\").concat(array[indexNew].time.minutes)});operate(API,value.active,value.direction,Number(value.duration));}catch(e){//\n}});});_context2.next=50;break;case 42:_context2.prev=42;_context2.t0=_context2[\"catch\"](33);console.log(_context2.t0);toast.error('Verifique as configuracoes');div.current.style.display='block';divStarted.current.style.display='none';buttonStart.current.innerText='Start';buttonStart.current.style.backgroundColor='green';case 50:_context2.next=55;break;case 52:_context2.prev=52;_context2.t1=_context2[\"catch\"](26);toast.error('Arquivo invalido');case 55:case\"end\":return _context2.stop();}}},_callee2,null,[[26,52],[33,42]]);}));return _handleClick.apply(this,arguments);}React.useEffect(function(){function getBalance(){return _getBalance.apply(this,arguments);}function _getBalance(){_getBalance=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var ws;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!balance){_context.next=2;break;}return _context.abrupt(\"return\");case 2:ws=new WebSocket('wss://iqoption.com/echo/websocket');ws.onopen=function(){console.log('Started');ws.send(JSON.stringify({\"name\":\"ssid\",\"msg\":iqoption.ssid}));};ws.onmessage=function(message){var myMessage=JSON.parse(message.data);if(myMessage.name==='profile'){var _myMessage$msg$balanc;setBalance((_myMessage$msg$balanc=myMessage.msg.balances[1])===null||_myMessage$msg$balanc===void 0?void 0:_myMessage$msg$balanc.amount);ws.close();}};case 5:case\"end\":return _context.stop();}}},_callee);}));return _getBalance.apply(this,arguments);}getBalance();});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(DivStarted,{ref:divStarted,children:[/*#__PURE__*/_jsx(\"p\",{children:\"Anterior\"}),/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[oldTrade.time,\" \",oldTrade.active,\" \",oldTrade.direction]})}),/*#__PURE__*/_jsx(\"p\",{children:\"Proximo\"}),/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[nextTrade.time,\" \",nextTrade.active,\" \",nextTrade.direction]})})]}),/*#__PURE__*/_jsx(DivChange,{ref:divChange,children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){if(div.current.style.display==='none'){div.current.style.display='block';divConfig.current.style.display='none';setButtonName('Configurar');return;}div.current.style.display='none';divConfig.current.style.display='block';setButtonName('Iniciar');},children:buttonName})}),/*#__PURE__*/_jsxs(DivConfig,{ref:divConfig,children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Banca \",/*#__PURE__*/_jsx(\"span\",{children:balance?\"$\".concat(balance):'Loading...'})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Delay \",/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",onChange:function onChange(e){var value=e.target.value;if(!value)return;setDelay(value);}})})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Stop Win \",/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",onChange:function onChange(e){var value=e.target.value;if(!value)return;setStopWin(value);}})})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Stop Loss \",/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",onChange:function onChange(e){var value=e.target.value;if(!value)return;setStopLoss(value);}})})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Entrada \",/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",onChange:function onChange(e){var value=e.target.value;if(!value)return;setEntrada(value);}})})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"MartinGales \",/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",onChange:function onChange(e){var value=e.target.value;if(!value)return;setMartinGales(value);}})})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Listas \",/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"text/plain\",onChange:function onChange(e){var file=e.target.files[0];setFile(file);}})})]})]}),/*#__PURE__*/_jsxs(Div,{ref:div,children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Banca \",/*#__PURE__*/_jsx(\"span\",{children:balance?\"$\".concat(balance):'Loading...'})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Delay \",/*#__PURE__*/_jsx(\"span\",{children:delay})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Stop Win \",/*#__PURE__*/_jsx(\"span\",{children:stopWin})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Stop Loss \",/*#__PURE__*/_jsx(\"span\",{children:stopLoss})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Entrada \",/*#__PURE__*/_jsx(\"span\",{children:entrada})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"MartinGales \",/*#__PURE__*/_jsx(\"span\",{children:martinGales})]})]}),/*#__PURE__*/_jsx(StartBot,{children:/*#__PURE__*/_jsx(\"button\",{ref:buttonStart,onClick:handleClick,children:\"Start\"})})]});}","map":{"version":3,"sources":["/home/user/Desktop/project/iqoption/src/pages/Main/index.tsx"],"names":["React","storage","schedule","IQOption","operate","axios","toast","Div","DivChange","DivConfig","DivStarted","StartBot","useSelector","useDispatch","LoginIQ","history","useState","stopWin","setStopWin","stopLoss","setStopLoss","delay","setDelay","file","setFile","balance","setBalance","buttonName","setButtonName","entrada","setEntrada","martinGales","setMartinGales","time","active","direction","oldTrade","setOldTrade","nextTrade","setNextTrade","buttonStart","useRef","div","divConfig","divChange","divStarted","martin","iqoption","state","dispatch","handleClick","e","current","innerText","style","display","backgroundColor","Object","keys","scheduledJobs","forEach","key","cancel","errors","push","length","value","error","gales","Number","i","formData","FormData","append","post","process","env","REACT_APP_HOST_APP","headers","data","promise","email","password","pending","success","API","console","log","hour","minutes","index","array","miutes","scheduleJob","minute","second","indexOld","indexNew","duration","useEffect","getBalance","ws","WebSocket","onopen","send","JSON","stringify","ssid","onmessage","message","myMessage","parse","name","msg","balances","amount","close","target","files"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport { RouteComponentProps } from 'react-router-dom';\nimport storage from '../../utils/storage';\n\nimport schedule from 'node-schedule';\n\nimport IQOption from 'iqoptionzzz';\nimport operate from '../../utils/operate'\n\nimport axios from 'axios';\n\nimport { toast } from 'react-toastify';\nimport { Div, DivChange, DivConfig, DivStarted, StartBot } from './styled';\n\nimport { useSelector, useDispatch } from 'react-redux';\n\n\nexport default function LoginIQ({ history }:{ history: RouteComponentProps['history'] }) {\n    const [ stopWin, setStopWin ] = React.useState(0);\n    const [ stopLoss, setStopLoss ] = React.useState(0);\n    const [ delay, setDelay ] = React.useState(0);\n    const [ file, setFile ] = React.useState<File>();\n    const [ balance, setBalance ] = React.useState<number | boolean>(false);\n    const [ buttonName, setButtonName ] = React.useState('Configurar');\n    const [ entrada, setEntrada ] = React.useState(0);\n    const [ martinGales, setMartinGales ] = React.useState(0);\n\n    const [ oldTrade, setOldTrade ] = React.useState({\n        time: '',\n        active: '',\n        direction: '',\n    });\n\n    const [ nextTrade, setNextTrade ] = React.useState({\n        time: '',\n        active: '',\n        direction: '',\n    });\n\n    const buttonStart = React.useRef<HTMLButtonElement>();\n\n    const div = React.useRef<HTMLDivElement>();\n    const divConfig = React.useRef<HTMLDivElement>();\n    const divChange = React.useRef<HTMLDivElement>();\n    const divStarted = React.useRef<HTMLDivElement>();\n\n    const martin = React.useRef<HTMLInputElement>();\n\n    const iqoption = useSelector((state: {\n        iqoption: {\n            email: string;\n            password: string;\n            ssid: string;\n        }\n    }) => state.iqoption);\n\n    const dispatch = useDispatch();\n    async function handleClick(e: React.ChangeEvent<any>): Promise<unknown> {\n        if(buttonStart.current.innerText === 'Stop') {\n            divStarted.current.style.display = 'none';\n            buttonStart.current.innerText = 'Start';\n            buttonStart.current.style.backgroundColor = 'green';\n            div.current.style.display = 'block';\n            divChange.current.style.display = 'block';\n\n            Object.keys(schedule.scheduledJobs).forEach((key) => {\n                schedule.scheduledJobs[key].cancel();\n            })\n\n            setOldTrade({\n                time: '',\n                active: '',\n                direction: '',\n            });\n\n            setNextTrade({\n                time: '',\n                active: '',\n                direction: '',\n            });\n            return;\n        }\n        \n        const errors: string[] = [];\n        if(!stopWin) errors.push('Preencha stopWin');\n        if(!stopLoss) errors.push('Preencha stopLoss');\n        if(!file) errors.push('Coloque uma lista');\n        if(!entrada) errors.push('Coloque uma entrada');\n\n        if(errors.length > 0) return errors.forEach((value) => {\n            toast.error(value);\n        });\n\n        if(buttonStart.current.innerText === 'Start') {\n            buttonStart.current.innerText = 'Stop';\n            buttonStart.current.style.backgroundColor = 'red';\n            div.current.style.display = 'none';\n            divConfig.current.style.display = 'none';\n            divChange.current.style.display = 'none';\n            divStarted.current.style.display = 'block';\n        } \n\n\n        const gales = [];\n        gales.push(Number(entrada));\n\n        for(let i = 0; martinGales > i; i++) {\n            gales.push(gales[gales.length - 1] * 2);\n        }\n\n        storage.setStopLoss(stopLoss);\n        storage.setStopWin(stopWin);\n        storage.setMartinGales(gales);\n        \n        const formData = new FormData();\n        formData.append('file', file);\n\n       try {\n           const { data }: { data: any } = await axios.post(`http://${process.env.REACT_APP_HOST_APP}/api/v2/sinais`, formData, {\n            headers: {\n                'Content-Type': 'multipart/form-data'\n            }\n\n        });\n\n        if(data.length === 0) return toast.error('Por favor adicione pelo menos 2 trades a lista');\n\n        try {\n            const API = await toast.promise(IQOption({\n                email: iqoption.email,\n                password: iqoption.password\n            }), {\n                pending: 'Aguarde',\n                success: 'Bot inicializado, nao feche o navegador',\n                error: 'Erro ao iniciar o bot'\n            });\n            console.log('IQOPTION CONNECTED');\n\n            setNextTrade({\n                active: data[0].active,\n                direction: data[0].direction,\n                time: `${data[0].time.hour}:${data[0].time.minutes}`\n            });\n\n            data.forEach((value, index, array) => {\n                let minutes = delay ? value.time.miutes - 1 : value.time.miutes;\n\n                schedule.scheduleJob({ hour: value.time.hour, minute: minutes, second: 60 - delay }, () => {\n                    try {\n                        let indexOld = index - 1;\n                if(index === 0) indexOld = 0;\n\n                let indexNew = index + 1;\n                if(array.length - 1 === index) indexNew = index;\n\n                setOldTrade({\n                    active: array[indexOld].active,\n                    direction: array[indexOld].direction,\n                    time: `${array[indexOld].time.hour}:${array[indexOld].time.minutes}`\n                });\n\n                setNextTrade({\n                    active: array[indexNew].active,\n                    direction: array[indexNew].direction,\n                    time: `${array[indexNew].time.hour}:${array[indexNew].time.minutes}`\n                });\n                \n                    operate(API, value.active, value.direction, Number(value.duration));\n                    } catch(e) {\n                        //\n                    }\n                });\n            });\n            \n        } catch(e) {\n            console.log(e);\n            toast.error('Verifique as configuracoes');\n            div.current.style.display = 'block';\n            divStarted.current.style.display = 'none';\n            buttonStart.current.innerText = 'Start';\n            buttonStart.current.style.backgroundColor = 'green';\n        }\n       } catch(e) {\n           toast.error('Arquivo invalido');\n       }\n\n       \n\n    }\n\n    React.useEffect(() => {\n         async function getBalance() {\n             if(balance) return;\n            const ws = new WebSocket('wss://iqoption.com/echo/websocket');\n\n           ws.onopen = () => {\n               console.log('Started');\n               ws.send(JSON.stringify({\"name\":\"ssid\",\"msg\": iqoption.ssid}));\n            }\n\n            ws.onmessage = (message) => {\n                const myMessage = JSON.parse(message.data) as {\n                    name: string;\n                    msg: {\n                        balances: {\n                            amount: number;\n                        }[];\n                    }\n                };\n                \n                if(myMessage.name === 'profile') {\n                    setBalance(myMessage.msg.balances[1]?.amount)\n                    ws.close();\n                }\n            }\n        }\n\n        getBalance();\n    });\n    return(\n        <>\n        <DivStarted ref={divStarted}>\n            <p>Anterior</p>\n            <button><p>{ oldTrade.time } { oldTrade.active } { oldTrade.direction }</p></button>\n\n            <p>Proximo</p>\n            <button><p>{ nextTrade.time } { nextTrade.active } { nextTrade.direction }</p></button>\n        </DivStarted>\n        <DivChange ref={divChange}>\n            <button onClick={(e: any) => {\n                if(div.current.style.display === 'none') {\n                    div.current.style.display = 'block';\n                    divConfig.current.style.display = 'none';\n                    setButtonName('Configurar');\n                    return;\n                }\n                \n                div.current.style.display = 'none';\n                divConfig.current.style.display = 'block';\n                \n                setButtonName('Iniciar');\n            }}>{ buttonName }</button>\n        </DivChange>\n        <DivConfig ref={divConfig}>\n            <h1>Banca <span>{ balance ? `$${balance}` : 'Loading...' }</span></h1>\n            <h1>Delay <span><input type=\"number\" onChange={(e) => {\n                const value = e.target.value as unknown as number;\n                if(!value) return;\n                setDelay(value);\n            }}/></span></h1>\n            <h1>Stop Win <span><input type=\"number\" onChange={(e) => {\n                const value = e.target.value as unknown as number;\n                if(!value) return;\n                setStopWin(value);\n            }}/></span></h1>\n            <h1>Stop Loss <span><input type=\"number\" onChange={(e) => {\n                const value = e.target.value as unknown as number;\n                if(!value) return;\n                setStopLoss(value);\n            }}/></span></h1>\n             <h1>Entrada <span><input type=\"number\" onChange={(e) => {\n                const value = e.target.value as unknown as number;\n                if(!value) return;\n                setEntrada(value);\n            }}/></span></h1>\n            <h1>MartinGales <span><input type=\"number\" onChange={(e) => {\n                const value = e.target.value as unknown as number;\n                if(!value) return;\n                setMartinGales(value);\n            }}/></span></h1>\n            <h1>Listas <span><input type=\"file\" accept=\"text/plain\" onChange={(e) => {\n                const file = e.target.files[0];\n                setFile(file);\n            }} /></span></h1>\n        </DivConfig>\n\n        <Div ref={div}>\n            <h1>Banca <span>{ balance ? `$${balance}` : 'Loading...' }</span></h1>\n            <h1>Delay <span>{ delay }</span></h1>\n            <h1>Stop Win <span>{ stopWin }</span></h1>\n            <h1>Stop Loss <span>{ stopLoss }</span></h1>\n            <h1>Entrada <span>{ entrada }</span></h1>\n            <h1>MartinGales <span>{ martinGales }</span></h1>\n        </Div>\n\n        <StartBot>\n            <button ref={buttonStart} onClick={handleClick}>Start</button>\n        </StartBot>\n        </>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}