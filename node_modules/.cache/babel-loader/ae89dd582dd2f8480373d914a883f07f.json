{"ast":null,"code":"import _regeneratorRuntime from\"/home/user/Desktop/project/iqoption/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/user/Desktop/project/iqoption/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/user/Desktop/project/iqoption/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import axios from'axios';import logoIq from'../../assets/img/logo_iq.png';import{toast}from'react-toastify';import{Div,Banner}from'./styled';import{useDispatch}from'react-redux';import*as actions from'../../store/modules/iqoption/action';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function LoginIQ(_ref){var history=_ref.history;var _React$useState=React.useState(''),_React$useState2=_slicedToArray(_React$useState,2),email=_React$useState2[0],setEmail=_React$useState2[1];var _React$useState3=React.useState(''),_React$useState4=_slicedToArray(_React$useState3,2),password=_React$useState4[0],setPassword=_React$useState4[1];var button=React.useRef();var dispatch=useDispatch();function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _yield$toast$promise,ssid;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();button.current.disabled=true;if(!(!email||!password)){_context.next=6;break;}toast.error('Campos vazios');button.current.disabled=false;return _context.abrupt(\"return\");case 6:_context.prev=6;_context.next=9;return toast.promise(axios.post(\"http://\".concat(process.env.REACT_APP_PUBLIC_URL,\"/api/v2/login\"),{identifier:email,password:password}),{success:'Logado com sucesso',error:'Falha no login',pending:'Carregando'});case 9:_yield$toast$promise=_context.sent;ssid=_yield$toast$promise.data.ssid;dispatch(actions.loginIqoption({email:email,password:password,ssid:ssid}));history.push('/main');_context.next=19;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](6);dispatch(actions.logoutIqoption());button.current.disabled=false;case 19:case\"end\":return _context.stop();}}},_callee,null,[[6,15]]);}));return _handleSubmit.apply(this,arguments);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Banner,{children:/*#__PURE__*/_jsx(\"img\",{src:logoIq,alt:\"Logo\"})}),/*#__PURE__*/_jsx(Div,{children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"p\",{children:\"Email:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",onChange:function onChange(e){setEmail(e.target.value);}}),/*#__PURE__*/_jsx(\"p\",{children:\"Senha:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",onChange:function onChange(e){setPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{ref:button,type:\"submit\",children:\"Entrar\"})]})})]});}","map":{"version":3,"sources":["/home/user/Desktop/project/iqoption/src/pages/LoginIQ/index.tsx"],"names":["React","axios","logoIq","toast","Div","Banner","useDispatch","actions","LoginIQ","history","useState","email","setEmail","password","setPassword","button","useRef","dispatch","handleSubmit","e","preventDefault","current","disabled","error","promise","post","process","env","REACT_APP_PUBLIC_URL","identifier","success","pending","ssid","data","loginIqoption","push","logoutIqoption","target","value"],"mappings":"2cAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CAEA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAIA,MAAOC,CAAAA,MAAP,KAAmB,8BAAnB,CAEA,OAASC,KAAT,KAAsB,gBAAtB,CACA,OAASC,GAAT,CAAcC,MAAd,KAA4B,UAA5B,CAEA,OAASC,WAAT,KAA4B,aAA5B,CACA,MAAO,GAAKC,CAAAA,OAAZ,KAAyB,qCAAzB,C,6IAEA,cAAe,SAASC,CAAAA,OAAT,MAA0E,IAAvDC,CAAAA,OAAuD,MAAvDA,OAAuD,CACrF,oBAA4BT,KAAK,CAACU,QAAN,CAAe,EAAf,CAA5B,oDAAQC,KAAR,qBAAeC,QAAf,qBACA,qBAAkCZ,KAAK,CAACU,QAAN,CAAe,EAAf,CAAlC,qDAAQG,QAAR,qBAAkBC,WAAlB,qBAEA,GAAMC,CAAAA,MAAM,CAAGf,KAAK,CAACgB,MAAN,EAAf,CAEA,GAAMC,CAAAA,QAAQ,CAAGX,WAAW,EAA5B,CANqF,QAQtEY,CAAAA,YARsE,gJAQrF,iBAA4BC,CAA5B,gJACIA,CAAC,CAACC,cAAF,GACAL,MAAM,CAACM,OAAP,CAAeC,QAAf,CAA0B,IAA1B,CAFJ,KAIO,CAACX,KAAD,EAAU,CAACE,QAJlB,0BAKQV,KAAK,CAACoB,KAAN,CAAY,eAAZ,EACAR,MAAM,CAACM,OAAP,CAAeC,QAAf,CAA0B,KAA1B,CANR,8EAUsEnB,CAAAA,KAAK,CAACqB,OAAN,CAAcvB,KAAK,CAACwB,IAAN,kBAAqBC,OAAO,CAACC,GAAR,CAAYC,oBAAjC,kBAAsE,CAC9IC,UAAU,CAAElB,KADkI,CAE9IE,QAAQ,CAARA,QAF8I,CAAtE,CAAd,CAG1D,CACAiB,OAAO,CAAE,oBADT,CAEAP,KAAK,CAAE,gBAFP,CAGAQ,OAAO,CAAE,YAHT,CAH0D,CAVtE,2CAUwBC,IAVxB,sBAUgBC,IAVhB,CAUwBD,IAVxB,CAmBQf,QAAQ,CAACV,OAAO,CAAC2B,aAAR,CAAsB,CAC3BvB,KAAK,CAAEA,KADoB,CAE3BE,QAAQ,CAARA,QAF2B,CAG3BmB,IAAI,CAAEA,IAHqB,CAAtB,CAAD,CAAR,CAKDvB,OAAO,CAAC0B,IAAR,CAAa,OAAb,EAxBP,iFA0BQlB,QAAQ,CAACV,OAAO,CAAC6B,cAAR,EAAD,CAAR,CACArB,MAAM,CAACM,OAAP,CAAeC,QAAf,CAA0B,KAA1B,CA3BR,qEARqF,+CAuCrF,mBACI,wCACA,KAAC,MAAD,wBACI,YAAK,GAAG,CAAEpB,MAAV,CAAkB,GAAG,CAAC,MAAtB,EADJ,EADA,cAKA,KAAC,GAAD,wBACI,cAAM,QAAQ,CAAEgB,YAAhB,wBACI,6BADJ,cAEI,cAAO,IAAI,CAAC,OAAZ,CAAoB,QAAQ,CAAE,kBAACC,CAAD,CAAO,CACjCP,QAAQ,CAACO,CAAC,CAACkB,MAAF,CAASC,KAAV,CAAR,CACH,CAFD,EAFJ,cAKI,6BALJ,cAMI,cAAO,IAAI,CAAC,UAAZ,CAAuB,QAAQ,CAAE,kBAACnB,CAAD,CAAO,CACpCL,WAAW,CAACK,CAAC,CAACkB,MAAF,CAASC,KAAV,CAAX,CACH,CAFD,EANJ,cAUI,eAAQ,GAAG,CAAEvB,MAAb,CAAqB,IAAI,CAAC,QAA1B,oBAVJ,GADJ,EALA,GADJ,CAsBH","sourcesContent":["import React from 'react';\n\nimport axios from 'axios';\n\nimport { RouteComponentProps } from 'react-router-dom';\n\nimport logoIq from '../../assets/img/logo_iq.png';\n\nimport { toast } from 'react-toastify';\nimport { Div, Banner } from './styled';\n\nimport { useDispatch } from 'react-redux';\nimport * as actions from '../../store/modules/iqoption/action';\n\nexport default function LoginIQ({ history }:{ history: RouteComponentProps['history'] }) {\n    const [ email, setEmail ] = React.useState('');\n    const [ password, setPassword ] = React.useState('');\n\n    const button = React.useRef<HTMLButtonElement>();\n    \n    const dispatch = useDispatch();\n\n    async function handleSubmit(e: React.FormEvent<HTMLFormElement>): Promise<void> {\n        e.preventDefault();\n        button.current.disabled = true;\n\n        if(!email || !password) {\n            toast.error('Campos vazios');\n            button.current.disabled = false;\n            return;\n        }\n        try {\n            const { data: { ssid } }: { data: { ssid: string; } } = await toast.promise(axios.post(`http://${process.env.REACT_APP_PUBLIC_URL}/api/v2/login`, {\n                identifier: email,\n                password\n            }), {\n                success: 'Logado com sucesso',\n                error: 'Falha no login',\n                pending: 'Carregando'\n            });\n\n            dispatch(actions.loginIqoption({\n                email: email,\n                password,\n                ssid: ssid\n            }));\n           history.push('/main');\n        } catch(e) {\n            dispatch(actions.logoutIqoption());\n            button.current.disabled = false;\n        }\n    }\n    \n    return(\n        <>\n        <Banner>\n            <img src={logoIq} alt=\"Logo\" />\n        </Banner>\n\n        <Div>\n            <form onSubmit={handleSubmit}>\n                <p>Email:</p>\n                <input type=\"email\" onChange={(e) => {\n                    setEmail(e.target.value);\n                }}/>\n                <p>Senha:</p>\n                <input type=\"password\" onChange={(e) => {\n                    setPassword(e.target.value);\n                }} />\n\n                <button ref={button} type=\"submit\">Entrar</button>\n            </form>\n        </Div>\n        </>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}