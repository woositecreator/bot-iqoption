{"ast":null,"code":"import _toConsumableArray from\"/home/user/Desktop/project/iqoption/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/home/user/Desktop/project/iqoption/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/user/Desktop/project/iqoption/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/user/Desktop/project/iqoption/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import storage from'../../utils/storage';import schedule from'node-schedule';import IQOption from'iqoptionzzz';import operate from'../../utils/operate';import axios from'axios';import{toast}from'react-toastify';import{Div,DivChange,DivConfig,DivStarted,StartBot}from'./styled';import{useSelector}from'react-redux';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function LoginIQ(_ref){var history=_ref.history;var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),stopWin=_React$useState2[0],setStopWin=_React$useState2[1];var _React$useState3=React.useState(0),_React$useState4=_slicedToArray(_React$useState3,2),stopLoss=_React$useState4[0],setStopLoss=_React$useState4[1];var _React$useState5=React.useState(0),_React$useState6=_slicedToArray(_React$useState5,2),delay=_React$useState6[0],setDelay=_React$useState6[1];var _React$useState7=React.useState(),_React$useState8=_slicedToArray(_React$useState7,2),file=_React$useState8[0],setFile=_React$useState8[1];var _React$useState9=React.useState(false),_React$useState10=_slicedToArray(_React$useState9,2),balance=_React$useState10[0],setBalance=_React$useState10[1];var _React$useState11=React.useState('Configurar'),_React$useState12=_slicedToArray(_React$useState11,2),buttonName=_React$useState12[0],setButtonName=_React$useState12[1];var _React$useState13=React.useState([]),_React$useState14=_slicedToArray(_React$useState13,2),martinGales=_React$useState14[0],setMartinGales=_React$useState14[1];var _React$useState15=React.useState({time:'',active:'',direction:''}),_React$useState16=_slicedToArray(_React$useState15,2),oldTrade=_React$useState16[0],setOldTrade=_React$useState16[1];var _React$useState17=React.useState({time:'',active:'',direction:''}),_React$useState18=_slicedToArray(_React$useState17,2),nextTrade=_React$useState18[0],setNextTrade=_React$useState18[1];var buttonStart=React.useRef();var div=React.useRef();var divConfig=React.useRef();var divChange=React.useRef();var divStarted=React.useRef();var martin=React.useRef();var iqoption=useSelector(function(state){return state.iqoption;});function handleClick(_x){return _handleClick.apply(this,arguments);}function _handleClick(){_handleClick=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var errors,formData,_yield$axios$post,data,API;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(buttonStart.current.innerText==='Stop')){_context2.next=7;break;}divStarted.current.style.display='none';buttonStart.current.innerText='Start';buttonStart.current.style.backgroundColor='green';div.current.style.display='block';divChange.current.style.display='block';return _context2.abrupt(\"return\");case 7:errors=[];if(!stopWin)errors.push('Preencha stopWin');if(!stopLoss)errors.push('Preencha stopLoss');if(!file)errors.push('Coloque uma lista');if(martinGales.length===0)errors.push('Preencha os martingales');if(!(errors.length>0)){_context2.next=14;break;}return _context2.abrupt(\"return\",errors.forEach(function(value){toast.error(value);}));case 14:if(buttonStart.current.innerText==='Start'){buttonStart.current.innerText='Stop';buttonStart.current.style.backgroundColor='red';div.current.style.display='none';divConfig.current.style.display='none';divChange.current.style.display='none';divStarted.current.style.display='block';}storage.setStopLoss(stopLoss);storage.setStopWin(stopWin);storage.setMartinGales(martinGales);formData=new FormData();formData.append('file',file);_context2.prev=20;_context2.next=23;return axios.post(\"http://\".concat(process.env.REACT_APP_HOST_APP,\"/sinais\"),formData,{headers:{'Content-Type':'multipart/form-data'}});case 23:_yield$axios$post=_context2.sent;data=_yield$axios$post.data;if(!(data.length===0)){_context2.next=27;break;}return _context2.abrupt(\"return\",toast.error('Por favor adicione pelo menos 2 trades a lista'));case 27:_context2.prev=27;_context2.next=30;return toast.promise(IQOption({email:iqoption.email,password:iqoption.password}),{pending:'Aguarde',success:'Bot inicializado, nao feche o navegador',error:'Erro ao iniciar o bot'});case 30:API=_context2.sent;console.log('IQOPTION CONNECTED');setOldTrade({active:data[0].active,direction:data[0].direction,time:\"\".concat(data[0].time.hour,\":\").concat(data[0].time.minutes)});data.forEach(function(value,index,array){schedule.scheduleJob({hour:value.time.hour,minute:value.time.minutes},function(){try{var indexOld=index-1;if(index===0)indexOld=0;var indexNew=index+1;if(array.length-1===index)indexNew=index;setOldTrade({active:array[indexOld].active,direction:array[indexOld].direction,time:\"\".concat(array[indexOld].time.hour,\":\").concat(array[indexOld].time.minutes)});setNextTrade({active:array[indexNew].active,direction:array[indexNew].direction,time:\"\".concat(array[indexNew].time.hour,\":\").concat(array[indexNew].time.minutes)});operate(API,value.active,value.direction,Number(value.duration));}catch(e){//\n}});});_context2.next=44;break;case 36:_context2.prev=36;_context2.t0=_context2[\"catch\"](27);console.log(_context2.t0);toast.error('Verifique as configuracoes');div.current.style.display='block';divStarted.current.style.display='none';buttonStart.current.innerText='Start';buttonStart.current.style.backgroundColor='green';case 44:_context2.next=49;break;case 46:_context2.prev=46;_context2.t1=_context2[\"catch\"](20);toast.error('Arquivo invalido');case 49:case\"end\":return _context2.stop();}}},_callee2,null,[[20,46],[27,36]]);}));return _handleClick.apply(this,arguments);}React.useEffect(function(){function getBalance(){return _getBalance.apply(this,arguments);}function _getBalance(){_getBalance=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var ws;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!balance){_context.next=2;break;}return _context.abrupt(\"return\");case 2:ws=new WebSocket('wss://iqoption.com/echo/websocket');ws.onopen=function(){console.log('Started');ws.send(JSON.stringify({\"name\":\"ssid\",\"msg\":iqoption.ssid}));};ws.onmessage=function(message){var myMessage=JSON.parse(message.data);if(myMessage.name==='profile'){setBalance(myMessage.msg.balances[1].amount);ws.close();}};case 5:case\"end\":return _context.stop();}}},_callee);}));return _getBalance.apply(this,arguments);}getBalance();});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(DivStarted,{ref:divStarted,children:[/*#__PURE__*/_jsx(\"p\",{children:\"Anterior\"}),/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[oldTrade.time,\" \",oldTrade.active,\" \",oldTrade.direction]})}),/*#__PURE__*/_jsx(\"p\",{children:\"Proximo\"}),/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[nextTrade.time,\" \",nextTrade.active,\" \",nextTrade.direction]})})]}),/*#__PURE__*/_jsx(DivChange,{ref:divChange,children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){if(div.current.style.display==='none'){div.current.style.display='block';divConfig.current.style.display='none';setButtonName('Configurar');return;}div.current.style.display='none';divConfig.current.style.display='block';setButtonName('Iniciar');},children:buttonName})}),/*#__PURE__*/_jsxs(DivConfig,{ref:divConfig,children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Banca \",/*#__PURE__*/_jsx(\"span\",{children:balance?\"$\".concat(balance):'Loading...'})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Delay \",/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",onChange:function onChange(e){var value=e.target.value;if(!value)return;setDelay(value);}})})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Stop Win \",/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",onChange:function onChange(e){var value=e.target.value;if(!value)return;setStopWin(value);}})})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Stop Loss \",/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",onChange:function onChange(e){var value=e.target.value;if(!value)return;setStopLoss(value);}})})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"MartinGale \",/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"input\",{ref:martin,type:\"number\"}),\" \",/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){var value=martin.current.value;if(isNaN(value))return;var splited=value.split(' ');if(splited[0]==='')return;setMartinGales(function(state){var newState=_toConsumableArray(state);newState.push(Number(value));martin.current.value='';return newState;});},children:\"Add\"})]})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Listas \",/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"text/plain\",onChange:function onChange(e){var file=e.target.files[0];setFile(file);}})})]})]}),/*#__PURE__*/_jsxs(Div,{ref:div,children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Banca \",/*#__PURE__*/_jsx(\"span\",{children:balance?\"$\".concat(balance):'Loading...'})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Delay \",/*#__PURE__*/_jsx(\"span\",{children:delay})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Stop Win \",/*#__PURE__*/_jsx(\"span\",{children:stopWin})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Stop Loss \",/*#__PURE__*/_jsx(\"span\",{children:stopLoss})]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"MartinGales \",/*#__PURE__*/_jsx(\"span\",{children:martinGales.map(function(value){return\"\".concat(value,\"\\n\");})})]})]}),/*#__PURE__*/_jsx(StartBot,{children:/*#__PURE__*/_jsx(\"button\",{ref:buttonStart,onClick:handleClick,children:\"Start\"})})]});}","map":{"version":3,"sources":["/home/user/Desktop/project/iqoption/src/pages/Main/index.tsx"],"names":["React","storage","schedule","IQOption","operate","axios","toast","Div","DivChange","DivConfig","DivStarted","StartBot","useSelector","LoginIQ","history","useState","stopWin","setStopWin","stopLoss","setStopLoss","delay","setDelay","file","setFile","balance","setBalance","buttonName","setButtonName","martinGales","setMartinGales","time","active","direction","oldTrade","setOldTrade","nextTrade","setNextTrade","buttonStart","useRef","div","divConfig","divChange","divStarted","martin","iqoption","state","handleClick","e","current","innerText","style","display","backgroundColor","errors","push","length","forEach","value","error","formData","FormData","append","post","process","env","REACT_APP_HOST_APP","headers","data","promise","email","password","pending","success","API","console","log","hour","minutes","index","array","scheduleJob","minute","indexOld","indexNew","Number","duration","useEffect","getBalance","ws","WebSocket","onopen","send","JSON","stringify","ssid","onmessage","message","myMessage","parse","name","msg","balances","amount","close","target","isNaN","splited","split","newState","files","map"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport { RouteComponentProps } from 'react-router-dom';\nimport storage from '../../utils/storage'\n\nimport schedule from 'node-schedule';\n\nimport IQOption from 'iqoptionzzz';\nimport operate from '../../utils/operate'\n\nimport axios from 'axios';\n\nimport { toast } from 'react-toastify';\nimport { Div, DivChange, DivConfig, DivStarted, StartBot } from './styled';\n\nimport { useSelector } from 'react-redux';\n\n\nexport default function LoginIQ({ history }:{ history: RouteComponentProps['history'] }) {\n    const [ stopWin, setStopWin ] = React.useState(0);\n    const [ stopLoss, setStopLoss ] = React.useState(0);\n    const [ delay, setDelay ] = React.useState(0);\n    const [ file, setFile ] = React.useState<File>();\n    const [ balance, setBalance ] = React.useState<number | boolean>(false);\n    const [ buttonName, setButtonName ] = React.useState('Configurar');\n    const [ martinGales, setMartinGales ] = React.useState<number[]>([]);\n\n    const [ oldTrade, setOldTrade ] = React.useState({\n        time: '',\n        active: '',\n        direction: '',\n    });\n\n    const [ nextTrade, setNextTrade ] = React.useState({\n        time: '',\n        active: '',\n        direction: '',\n    });\n\n    const buttonStart = React.useRef<HTMLButtonElement>();\n\n    const div = React.useRef<HTMLDivElement>();\n    const divConfig = React.useRef<HTMLDivElement>();\n    const divChange = React.useRef<HTMLDivElement>();\n    const divStarted = React.useRef<HTMLDivElement>();\n\n    const martin = React.useRef<HTMLInputElement>();\n\n    const iqoption = useSelector((state: {\n        iqoption: {\n            email: string;\n            password: string;\n            ssid: string;\n        }\n    }) => state.iqoption);\n    \n    async function handleClick(e: React.ChangeEvent<any>): Promise<unknown> {\n        if(buttonStart.current.innerText === 'Stop') {\n            divStarted.current.style.display = 'none';\n            buttonStart.current.innerText = 'Start';\n            buttonStart.current.style.backgroundColor = 'green';\n            div.current.style.display = 'block';\n            divChange.current.style.display = 'block';\n\n\n            return;\n        }\n        \n        const errors: string[] = [];\n        if(!stopWin) errors.push('Preencha stopWin');\n        if(!stopLoss) errors.push('Preencha stopLoss');\n        if(!file) errors.push('Coloque uma lista');\n        if(martinGales.length === 0) errors.push('Preencha os martingales');\n\n        if(errors.length > 0) return errors.forEach((value) => {\n            toast.error(value);\n        });\n\n        if(buttonStart.current.innerText === 'Start') {\n            buttonStart.current.innerText = 'Stop';\n            buttonStart.current.style.backgroundColor = 'red';\n            div.current.style.display = 'none';\n            divConfig.current.style.display = 'none';\n            divChange.current.style.display = 'none';\n            divStarted.current.style.display = 'block';\n        } \n\n\n        storage.setStopLoss(stopLoss);\n        storage.setStopWin(stopWin);\n        storage.setMartinGales(martinGales);\n\n        const formData = new FormData();\n        formData.append('file', file);\n\n       try {\n           const { data }: { data: any } = await axios.post(`http://${process.env.REACT_APP_HOST_APP}/sinais`, formData, {\n            headers: {\n                'Content-Type': 'multipart/form-data'\n            }\n\n        });\n\n        if(data.length === 0) return toast.error('Por favor adicione pelo menos 2 trades a lista');\n\n        try {\n            const API = await toast.promise(IQOption({\n                email: iqoption.email,\n                password: iqoption.password\n            }), {\n                pending: 'Aguarde',\n                success: 'Bot inicializado, nao feche o navegador',\n                error: 'Erro ao iniciar o bot'\n            });\n            console.log('IQOPTION CONNECTED');\n\n            setOldTrade({\n                active: data[0].active,\n                direction: data[0].direction,\n                time: `${data[0].time.hour}:${data[0].time.minutes}`\n            });\n\n            data.forEach((value, index, array) => {\n                schedule.scheduleJob({ hour: value.time.hour, minute: value.time.minutes}, () => {\n                    try {\n                        let indexOld = index - 1;\n                if(index === 0) indexOld = 0;\n\n                let indexNew = index + 1;\n                if(array.length - 1 === index) indexNew = index;\n\n                setOldTrade({\n                    active: array[indexOld].active,\n                    direction: array[indexOld].direction,\n                    time: `${array[indexOld].time.hour}:${array[indexOld].time.minutes}`\n                });\n\n                setNextTrade({\n                    active: array[indexNew].active,\n                    direction: array[indexNew].direction,\n                    time: `${array[indexNew].time.hour}:${array[indexNew].time.minutes}`\n                });\n                \n                    operate(API, value.active, value.direction, Number(value.duration));\n                    } catch(e) {\n                        //\n                    }\n                });\n            });\n            \n        } catch(e) {\n            console.log(e);\n            toast.error('Verifique as configuracoes');\n            div.current.style.display = 'block';\n            divStarted.current.style.display = 'none';\n            buttonStart.current.innerText = 'Start';\n            buttonStart.current.style.backgroundColor = 'green';\n        }\n       } catch(e) {\n           toast.error('Arquivo invalido');\n       }\n\n       \n\n    }\n\n    React.useEffect(() => {\n         async function getBalance() {\n             if(balance) return;\n            const ws = new WebSocket('wss://iqoption.com/echo/websocket');\n\n           ws.onopen = () => {\n               console.log('Started');\n               ws.send(JSON.stringify({\"name\":\"ssid\",\"msg\": iqoption.ssid}));\n            }\n\n            ws.onmessage = (message) => {\n                const myMessage = JSON.parse(message.data) as {\n                    name: string;\n                    msg: {\n                        balances: {\n                            amount: number;\n                        }[];\n                    }\n                };\n                \n                if(myMessage.name === 'profile') {\n                    setBalance(myMessage.msg.balances[1].amount)\n                    ws.close();\n                }\n            }\n        }\n\n        getBalance();\n    });\n    return(\n        <>\n        <DivStarted ref={divStarted}>\n            <p>Anterior</p>\n            <button><p>{ oldTrade.time } { oldTrade.active } { oldTrade.direction }</p></button>\n\n            <p>Proximo</p>\n            <button><p>{ nextTrade.time } { nextTrade.active } { nextTrade.direction }</p></button>\n        </DivStarted>\n        <DivChange ref={divChange}>\n            <button onClick={(e: any) => {\n                if(div.current.style.display === 'none') {\n                    div.current.style.display = 'block';\n                    divConfig.current.style.display = 'none';\n                    setButtonName('Configurar');\n                    return;\n                }\n                \n                div.current.style.display = 'none';\n                divConfig.current.style.display = 'block';\n                \n                setButtonName('Iniciar');\n            }}>{ buttonName }</button>\n        </DivChange>\n        <DivConfig ref={divConfig}>\n            <h1>Banca <span>{ balance ? `$${balance}` : 'Loading...' }</span></h1>\n            <h1>Delay <span><input type=\"number\" onChange={(e) => {\n                const value = e.target.value as unknown as number;\n                if(!value) return;\n                setDelay(value);\n            }}/></span></h1>\n            <h1>Stop Win <span><input type=\"number\" onChange={(e) => {\n                const value = e.target.value as unknown as number;\n                if(!value) return;\n                setStopWin(value);\n            }}/></span></h1>\n            <h1>Stop Loss <span><input type=\"number\" onChange={(e) => {\n                const value = e.target.value as unknown as number;\n                if(!value) return;\n                setStopLoss(value);\n            }}/></span></h1>\n            <h1>MartinGale <span><input ref={martin} type=\"number\" /> <button onClick={() => {\n                const value = martin.current.value as unknown as number;\n                if(isNaN(value)) return;\n                const splited = (value as unknown as string).split(' ');\n                if(splited[0] === '') return;\n                setMartinGales((state) => {\n                    const newState = [ ...state ];\n                    newState.push(Number(value));\n                    martin.current.value = '';\n                    return newState;\n                });\n            }}>Add</button></span></h1>\n            <h1>Listas <span><input type=\"file\" accept=\"text/plain\" onChange={(e) => {\n                const file = e.target.files[0];\n                setFile(file);\n            }} /></span></h1>\n        </DivConfig>\n\n        <Div ref={div}>\n            <h1>Banca <span>{ balance ? `$${balance}` : 'Loading...' }</span></h1>\n            <h1>Delay <span>{ delay }</span></h1>\n            <h1>Stop Win <span>{ stopWin }</span></h1>\n            <h1>Stop Loss <span>{ stopLoss }</span></h1>\n            <h1>MartinGales <span>{ martinGales.map((value) => {\n                return `${value}\\n`;\n            }) }</span></h1>\n        </Div>\n\n        <StartBot>\n            <button ref={buttonStart} onClick={handleClick}>Start</button>\n        </StartBot>\n        </>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}